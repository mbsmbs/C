# 가변 인자 함수

## 반환형 함수명 (자료형이 정해진 매개변수 목록, ...);
- 정해지지 않은 수의 매개변수를 허용한다
- 최소 한 개의 정해진 자료형의 매개변수가 필요
- 가변인자 : '...'

### ```c #include <stdarg.h>```

### va_list
- 가변 인자 목록
- va_Start(), ca_Arg(), va_end() 매크로 함수 사용할 때 필요한 정보가 포함

### va_Start()
```c
va_start(가변 인자 목록, 가변 인자 시작하기 직전 매개변수);
```
- 매크로 함수
- 함수 매개변수로 들어온 가변 인자들에 접근하기 전에 반드시 호출해야 함
- va_list에 필요한 초기화 수행:
  - 가변 인자가 스택 메모리의 어디서부터 시작하는지 찾아냄
  - 그래서 2번째 매개변수가 필요
  
### va_end()
```c
va_end(가변 인자 목록);
```
- 매크로 함수
- 함수 매개변수로 들어온 가변 인자들에 접근이 끝난뒤에 반드시 호출해야함
- 사용했던 가변 인자 목록을 정리함
  - 더 이상 가변 인자 목록을 사용 할 수 없도록 가변 인자 목록의 값을 수정함
  
### 중괄호를 사용하여 가독성을 높이자
```c
va_list ap;

va_start(ap, count);
{
  //codes....
}
va_end(ap);
```

### va_Arg()
```c
va_Arg(가변 인자 목록, 언어올 가변 인자의 자료형);
```
- 매크로 함수
- 가변 인자 목록으로부터 다음 가변 인자를 가져옴
- 가져올 가변 인자의 자료형은 두 번째 매개변수로 알려줌
- 예전 표준상의 문제로 가변 인자 목록의 기본 자료형 인자들은 다음과 같이 승격됨
  - 모든 정수형은 int로
  - 모든 부동 소수점은 double로
- 따라서, 두 번째 매개변수에는 int나 double을 쓸 것

### 매크로 함수
- 함수처럼 보이지만 함수는 아님
- 전처리기가 매크로 함수의 구현 코드로 대체시켜 줌

### 가변 인자 함수가 인자를 읽어오는 방법
- 가변 인자 함수를 호출하는 호출자는 매개변수 몇 개를  넣어야 하는지 안다
- 따라서 그냥 다 넣어 줌

1. ca_start(ap, count); : 가변 인자 시작 직전 매개변수에 기초해서 가변 인자 목록의 시작 메모리 주소를 계산

2. va_arg(ap, int); 가 호출될 때마다 int 크기만큼 더해가며 읽을 위치를 변경하면 됨.
  - 만약 ap.data가 1이 들어있는 메모리를 가리킨다면
  - 거기서 int 크기만큼 읽어 val1에 저장하고
  - 자기 자신을 int 크기만큼 증가시킴
  
  - 따라서 va_list는 스택 메모리에서 위치를 가리키는 포인터 같은 것을 가지고 있을 수 밖에

### 코드 : 218
